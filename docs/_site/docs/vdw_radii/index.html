<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Van der Waals Radii</title>
    <meta name="description" content="">


    <link rel="stylesheet" href="/chap/css/main.css">
    <link rel="stylesheet" href="/chap/css/font-awesome.min.css">

    <link rel="shortcut icon" href="/chap/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.2.2 -->
<title>Van der Waals Radii | CHAP</title>
<meta property="og:title" content="Van der Waals Radii" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/chap/docs/vdw_radii/" />
<meta property="og:url" content="http://localhost:4000/chap/docs/vdw_radii/" />
<meta property="og:site_name" content="CHAP" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-15T21:33:50+00:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Van der Waals Radii","datePublished":"2018-02-15T21:33:50+00:00","dateModified":"2018-02-15T21:33:50+00:00","url":"http://localhost:4000/chap/docs/vdw_radii/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="http://localhost:4000/chap/docs/vdw_radii/">
    <link rel="alternate" type="application/rss+xml" title="CHAP" href="http://localhost:4000/chap/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
            <a class="navbar-brand" href="/chap/">
                <span><img src="/chap/img/logonav.png"></span> CHAP
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li  class="active" ><a href="/chap/docs/home/">Documentation</a></li>
                <li ><a href="/chap/publications.html">Publications</a></li>
                <li ><a href="/chap/blog/2018/01/26/chap-at-bps/">News</a></li>
                <li ><a href="/chap/aboutus.html">About Us</a></li>
            </ul>
            <div class="navbar-right">
                <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                        <input id="search-box" type="text" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form>
                <ul class="nav navbar-nav">
                    <li><a href=""><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>



    <div class="page-content">
        <div class="wrapper">
            <div class="container">
    <div class="row">
        <div class="col-md-4">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
          Getting Started
        </a>
      </h4>
    </div>
    <div id="collapse-1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/home/">What CHAP Can Do</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/installing_chap/">Installing CHAP</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/annotation_example/">Annotation Example</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
          Running CHAP
        </a>
      </h4>
    </div>
    <div id="collapse-2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/chap_workflow/">Overview of CHAP Workflow</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/input_parameters/">Input Parameters</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-3" aria-expanded="false" aria-controls="collapse-3">
          Understanding Output
        </a>
      </h4>
    </div>
    <div id="collapse-3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/overview_output/">Overview of Output Files</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_json_file/">Contents of the JSON Output File</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_pdb_file/">Contents of the PDB Output File</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_objmtl_file/">Contents of the OBJ and MTL Output Files</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-4" aria-expanded="false" aria-controls="collapse-4">
          Visualising Results
        </a>
      </h4>
    </div>
    <div id="collapse-4" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/plotting_python/">Plotting in Python</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/plotting_r/">Plotting in R</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/molecular_graphics_pymol/">Molecular Graphics in PyMOL</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/molecular_graphics_vmd/">Molecular Graphics in VMD</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-5" aria-expanded="false" aria-controls="collapse-5">
          Data Sources
        </a>
      </h4>
    </div>
    <div id="collapse-5" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item active" href="/chap/docs/vdw_radii/">Van der Waals Radii</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/hydrophobicity_scales/">Hydrophobicity Scales</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/colour_palettes/">Colour Palettes</a>
        
      </ul>
    </div>
  </div>

</div>

        </div>

        <div class="col-md-8">
            <h1>Van der Waals Radii</h1>
            <div id="markdown-content-container">
<p>In order to find a permeation pathway through a channel protein, CHAP requires the van der Waals radii of the pathway-forming atoms. This page is intended to document the sources of the van der Waals radius data included in CHAP and to describe how custom data sets can be used.</p>

<h2 id="van-der-waals-radius-data-in-chap">Van der Waals Radius Data in CHAP</h2>

<p>The van der Waals radius databases provided by CHAP can be found in <code class="highlighter-rouge">chap/share/data/vdwradii/</code>, where each <a href="https://www.json.org/">JSON</a> file contains an individual data set. These data sets are the same as the ones used in the <a href="http://www.holeprogram.org/">HOLE</a> programme. The original work from which these radii have been taken is referenced below:</p>

<table>
  <thead>
    <tr>
      <th>Database</th>
      <th>Reference</th>
      <th>DOI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">hole_amberuni</code></td>
      <td>Weiner, Scott J., et al. “A new force field for molecular mechanical simulation of nucleic acids and proteins.” Journal of the American Chemical Society 106.3 (1984): 765-784.</td>
      <td><a href="https://doi.org/10.1021/ja00315a051">10.1021/ja00315a051</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hole_bondi</code></td>
      <td>Bondi, A. “van der Waals volumes and radii.” The Journal of Physical Chemistry 68.3 (1964): 441-451.</td>
      <td><a href="https://doi.org/10.1021/j100785a001">10.1021/j100785a001</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hole_hardcore</code></td>
      <td>Turano, Brian, Michael Pear, and David Busath. “Gramicidin channel selectivity. Molecular mechanics calculations for formamidinium, guanidinium, and acetamidinium.” Biophysical journal 63.1 (1992): 152-161.</td>
      <td><a href="https://doi.org/10.1016/S0006-3495(92)81574-6">10.1016/S0006-3495(92)81574-6</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hole_simple</code></td>
      <td>Weiner, Scott J., et al. “A new force field for molecular mechanical simulation of nucleic acids and proteins.” Journal of the American Chemical Society 106.3 (1984): 765-784.</td>
      <td><a href="https://doi.org/10.1021/ja00315a051">10.1021/ja00315a051</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hole_xplore</code></td>
      <td>Smart, Oliver S., et al. “HOLE: a program for the analysis of the pore dimensions of ion channel structural models.” Journal of molecular graphics 14.6 (1996): 354-360.</td>
      <td><a href="https://doi.org/10.1016/S0263-7855(97)00009-X">10.1016/S0263-7855(97)00009-X</a></td>
    </tr>
  </tbody>
</table>

<p>Users can can control which database is used by setting the <code class="highlighter-rouge">-pf-vdwr-database</code> flag. By default, the <code class="highlighter-rouge">hole_simple</code> database is used. Please note that the provided databases contain only van der Waals radii of atoms typically encountered in biomolecules (e.g. carbon, hydrogen, oxygen, nitrogen, and phosphorus). If the pathway forming group (specified with the <code class="highlighter-rouge">-sel-pathway</code> flag) contains any other atoms, you either have to provide a fallback van der Waals radius with the <code class="highlighter-rouge">-pf-vdwr-fallback</code> flag or provide a custom radius database as described in the following section.</p>

<h2 id="using-custom-van-der-waals-radii">Using Custom Van der Waals Radii</h2>

<p>In order to provide a set of custom van der Waals radii to CHAP, the <code class="highlighter-rouge">-pf-vdwr-database</code> flag needs to be set to <code class="highlighter-rouge">user</code> and the <code class="highlighter-rouge">-pf-vdwr-json</code> flag needs to specify a JSON file from which to read van der Waals radii.</p>

<p>The easiest way of creating such a JSON file will be to adapt one of the existing files located under <code class="highlighter-rouge">chap/share/data/vdwradii/</code>. CHAP expects the JSON file to contain an array of van der Waals radius records, where each record comprises a combination of atom and residue name and the associated van der Waals radius:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"vdwradii"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"C"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.185</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"H"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.100</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.175</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"O"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.165</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"P"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.210</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"S"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.200</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E2"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GLN"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.100</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D2"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASN"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.100</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LP"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nt">"atomname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MW"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"???"</span><span class="p">,</span><span class="w"> </span><span class="nt">"vdwr"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>Note that both residue and atom names can contain wild cards. Whan associating atoms with van der Waals radii, CHAP procedes according to the decision tree below:</p>

<p><img src="../../img/vdwr_decision_tree.svg" alt="Van der Waals radius decision tree" title="Van der Waals radius decision tree" /></p>

<p>CHAP will always try to find an exactly matching atom name first, before trying to find a matching wild card atom name or a matching element name. A wild card atom name is one where some characters in the atom name have been replaced by questions marks, e.g. <code class="highlighter-rouge">C???</code> would be a wild card for an atom whose name begins with <code class="highlighter-rouge">C</code> and may contain up to three further arbitrary characters. If, for example, a topology contains an atom named <code class="highlighter-rouge">CA</code> it would not be a match for record named <code class="highlighter-rouge">C</code>, but would be a wild card match for a record named <code class="highlighter-rouge">C???</code> (it would also be a match for a record named <code class="highlighter-rouge">CA</code>). If CHAP fails to find a record with an atom name that matches that of the trial atom either exactly or with wild cards, it will try to find a record that matches the atom’s (capitalised) element name, i.e. if there are no records named <code class="highlighter-rouge">CE2</code>, VdwRadiusProvider will try to find a record named <code class="highlighter-rouge">C</code> even if no wild card like <code class="highlighter-rouge">C???</code> is in the lookup table.</p>

<p>Internally, CHAP collects all records with matching atom name (or matching wild card atom name or matching element name) and will then try to find a record with matching residue name amongst these. Again, an exact name match is attempted first before trying a wild card match. In contrast to the atom name case, residue name wild cards always need to contain exactly three questionmarks (i.e. <code class="highlighter-rouge">???</code>); partial wild cards (e.g. <code class="highlighter-rouge">G??</code>) will be overlooked. If neither an exact nor a wild card residue name match is found, CHAP will continue its lookup with attempts to match wild card atom names (if it failed to find a matching residue name for a set of matching atom names) and to find matching element names (if it failed to find a matching residue name for a set of matching wild card atom names).</p>

<p>If no matching record could be found after trying to match element names, the last resort is to use the fallback radius set with <code class="highlighter-rouge">-pf-vdwr-fallback</code>. If no default radius has been set, CHAP will prompt an error message.</p>
</div>
            <p class="text-center">
              <br />
              <a target="_blank" href="/_docs/data-sources/vdw_radii.md" class="btn btn-default githubEditButton" role="button">
                <i class="fa fa-pencil fa-lg"></i> Improve this page
              </a>
            </p>
            <hr>
            





  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/chap/docs/molecular_graphics_vmd/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        
        
        <li class="next">
          <a href="/chap/docs/hydrophobicity_scales/">
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
    </div>
    <div class="clear"></div>
    

        </div>

    </div>
</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center">
            CHAP 2018 |
            Powered by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll Doc Theme</a>
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = '/chap'
</script>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="/chap/js/bootstrap.min.js "></script>
<script src="/chap/js/typeahead.bundle.min.js "></script>

<script src="/chap/js/main.js "></script>

</body>

</html>
