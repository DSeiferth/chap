<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Plotting in Python</title>
    <meta name="description" content="">


    <link rel="stylesheet" href="/chap/css/main.css">
    <link rel="stylesheet" href="/chap/css/font-awesome.min.css">

    <link rel="shortcut icon" href="/chap/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.2.2 -->
<title>Plotting in Python | CHAP</title>
<meta property="og:title" content="Plotting in Python" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/chap/docs/plotting_python/" />
<meta property="og:url" content="http://localhost:4000/chap/docs/plotting_python/" />
<meta property="og:site_name" content="CHAP" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-15T21:33:50+00:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Plotting in Python","datePublished":"2018-02-15T21:33:50+00:00","dateModified":"2018-02-15T21:33:50+00:00","url":"http://localhost:4000/chap/docs/plotting_python/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="http://localhost:4000/chap/docs/plotting_python/">
    <link rel="alternate" type="application/rss+xml" title="CHAP" href="http://localhost:4000/chap/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
            <a class="navbar-brand" href="/chap/">
                <span><img src="/chap/img/logonav.png"></span> CHAP
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li  class="active" ><a href="/chap/docs/home/">Documentation</a></li>
                <li ><a href="/chap/publications.html">Publications</a></li>
                <li ><a href="/chap/blog/2018/01/26/chap-at-bps/">News</a></li>
                <li ><a href="/chap/aboutus.html">About Us</a></li>
            </ul>
            <div class="navbar-right">
                <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                        <input id="search-box" type="text" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form>
                <ul class="nav navbar-nav">
                    <li><a href=""><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>



    <div class="page-content">
        <div class="wrapper">
            <div class="container">
    <div class="row">
        <div class="col-md-4">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
          Getting Started
        </a>
      </h4>
    </div>
    <div id="collapse-1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/home/">What CHAP Can Do</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/installing_chap/">Installing CHAP</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/annotation_example/">Annotation Example</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
          Running CHAP
        </a>
      </h4>
    </div>
    <div id="collapse-2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/chap_workflow/">Overview of CHAP Workflow</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/input_parameters/">Input Parameters</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-3" aria-expanded="false" aria-controls="collapse-3">
          Understanding Output
        </a>
      </h4>
    </div>
    <div id="collapse-3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/overview_output/">Overview of Output Files</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_json_file/">Contents of the JSON Output File</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_pdb_file/">Contents of the PDB Output File</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_objmtl_file/">Contents of the OBJ and MTL Output Files</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-4" aria-expanded="false" aria-controls="collapse-4">
          Visualising Results
        </a>
      </h4>
    </div>
    <div id="collapse-4" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item active" href="/chap/docs/plotting_python/">Plotting in Python</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/plotting_r/">Plotting in R</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/molecular_graphics_pymol/">Molecular Graphics in PyMOL</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/molecular_graphics_vmd/">Molecular Graphics in VMD</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-5" aria-expanded="false" aria-controls="collapse-5">
          Data Sources
        </a>
      </h4>
    </div>
    <div id="collapse-5" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/vdw_radii/">Van der Waals Radii</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/hydrophobicity_scales/">Hydrophobicity Scales</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/colour_palettes/">Colour Palettes</a>
        
      </ul>
    </div>
  </div>

</div>

        </div>

        <div class="col-md-8">
            <h1>Plotting in Python</h1>
            <div id="markdown-content-container">
<p>This page will walk you through loading CHAP output data into Python and show you how to visualise the radius profile of the permeation pathway. It also introduces a set of turnkey scripts bundled with CHAP that you can use to quickly visualise CHAP data. These scripts can serve as a good starting point for getting an overview of the data CHAP generates and can be adapted to suit your needs. It is assumed that you have some basic understanding of <a href="https://www.python.org/">Python</a> and in particular of the <a href="https://matplotlib.org/">matplotlib</a> plotting system.</p>

<h2 id="example-plotting-time-averaged-pathway-profiles">Example: Plotting Time-averaged Pathway Profiles</h2>

<p>As CHAP writes all relevant data into a single <a href="https://www.json.org/">JSON</a> file, you need to load a JSON parser. Fortunately, as of version 2.6, Python already comes with a JSON library, which can be loaded via <code class="highlighter-rouge">import json</code>. CHAP data can then be loaded simply via:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"output.json"</span><span class="p">)</span> <span class="k">as</span> <span class="n">data_file</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
</code></pre>
</div>

<p>This will parse the JSON data into a nested structure of Python dictionaries and arrays and you can use <code class="highlighter-rouge">data.keys()</code> to see how the data is structured at the highest level.</p>

<p>In order to plot the pathway radius profile, load the <code class="highlighter-rouge">matplotlib</code> and <code class="highlighter-rouge">numpy</code> libraries (these can be installed through <code class="highlighter-rouge">pip install matplotlib</code> and <code class="highlighter-rouge">pip install numpy</code>), then type the following:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># load plotting and numerics libraries:</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pl</span>

<span class="c"># begin new plot:</span>
<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s">"radius_profile"</span><span class="p">)</span>

<span class="c"># represent radius profile as black line:</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>                                                                        
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"pathwayProfile"</span><span class="p">][</span><span class="s">"s"</span><span class="p">]),</span>                                      
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"pathwayProfile"</span><span class="p">][</span><span class="s">"radiusMean"</span><span class="p">]),</span>                             
    <span class="s">"k-"</span><span class="p">)</span>  

<span class="c"># save plot to file:</span>
<span class="n">pl</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">"radius_profile.png"</span><span class="p">)</span>

<span class="c"># end figure definition:</span>
<span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">"radius_profile"</span><span class="p">)</span>
</code></pre>
</div>

<p>The file <code class="highlighter-rouge">radius_profile.png</code> now contains a figure showing how the pore radius varies along the length of the permeation pathway. In order to add confidence intervals to this, we can extend the above code with</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">pl</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>                                                                
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"pathwayProfile"</span><span class="p">][</span><span class="s">"s"</span><span class="p">]),</span>                                      
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"pathwayProfile"</span><span class="p">][</span><span class="s">"radiusMean"</span><span class="p">])</span> <span class="o">-</span> <span class="n">radius_sd</span><span class="p">,</span>                 
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"pathwayProfile"</span><span class="p">][</span><span class="s">"radiusMean"</span><span class="p">])</span> <span class="o">+</span> <span class="n">radius_sd</span><span class="p">,</span>                 
    <span class="n">facecolor</span> <span class="o">=</span> <span class="s">"#000000"</span><span class="p">,</span>                                                      
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</code></pre>
</div>

<p>which will add a grey shaded area corresponding to the one sigma confidence interval around the mean radius line.</p>

<p>In addition to the radius profile, it is also interesting to look at the residues lining the permeation pathway. The below code will add a scatter plot of the pore-facing residues coloured by their respective hydrophobicity:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">pf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"residueSummary"</span><span class="p">][</span><span class="s">"poreFacing"</span><span class="p">][</span><span class="s">"mean"</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.5</span> 
<span class="n">pl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>                                                                     
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"residueSummary"</span><span class="p">][</span><span class="s">"s"</span><span class="p">][</span><span class="s">"mean"</span><span class="p">])[</span><span class="n">pf</span><span class="p">],</span>                          
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"residueSummary"</span><span class="p">][</span><span class="s">"rho"</span><span class="p">][</span><span class="s">"mean"</span><span class="p">])[</span><span class="n">pf</span><span class="p">],</span>                        
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"residueSummary"</span><span class="p">][</span><span class="s">"hydrophobicity"</span><span class="p">])[</span><span class="n">pf</span><span class="p">],</span>                 
    <span class="n">marker</span> <span class="o">=</span> <span class="s">"o"</span><span class="p">,</span>                                                               
    <span class="n">cmap</span> <span class="o">=</span> <span class="s">"BrBG_r"</span><span class="p">)</span>                                                            
<span class="n">pl</span><span class="o">.</span><span class="n">clim</span><span class="p">(</span>                                                                        
    <span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"residueSummary"</span><span class="p">][</span><span class="s">"hydrophobicity"</span><span class="p">]))),</span>              
    <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"residueSummary"</span><span class="p">][</span><span class="s">"hydrophobicity"</span><span class="p">]))))</span>               
<span class="n">cbar</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>                                                            
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"Hydrophobicity (a.u.)"</span><span class="p">)</span>
</code></pre>
</div>

<p>Note that this only shows residues that are facing the permeation pathway more than 50% of the time.</p>

<p>All together, the above commands will generate a plot that should look like the following:</p>

<p><img src="../../img/time_averaged_radius_profile_python.svg" alt="Time-averaged radius profile" title="Time-averaged radius profile" /></p>

<p>A similar procedure can be used to create plots of other pathway properties such as its hydrophobicity or the local solvent density. Take a look at <code class="highlighter-rouge">chap/scripts/plotting/Python/chap_plot_pathway_profile.py</code> for an overview of what other pathway properties can be plotted.</p>

<h2 id="turnkey-plotting-scripts">Turnkey Plotting Scripts</h2>

<p>To get a quick overview of the results of a CHAP run you can use the plotting scripts available under <code class="highlighter-rouge">chap/scripts/plotting/Python/</code>. There are three scripts, <code class="highlighter-rouge">chap_plot_pathway_profile.py</code>, <code class="highlighter-rouge">chap_plot_scalar_time_series.py</code>, and <code class="highlighter-rouge">chap_plot_profile_time_series.py</code>, each of which generates a set of figures that display time-averaged pathway profiles, scalar-valued time series, and vector-valued time series respectively.</p>

<p>The scripts require Python to be installed and the <code class="highlighter-rouge">python2</code> command to be available. They also need the <code class="highlighter-rouge">argparse</code>, <code class="highlighter-rouge">numpy</code>, and <code class="highlighter-rouge">matplotlib</code> libraries, which can be installed using <code class="highlighter-rouge">pip</code> (for example: <code class="highlighter-rouge">pip install numpy</code>). The easiest way to use the scripts is to copy them into your working directory, where you can run them by simply typing</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>./chap_plot_pathway_profile.py -filename output.json -dpi 300
./chap_plot_scalar_time_series.py -filename output.json -dpi 300 
./chap_plot_profile_time_series.py -filename output.json -dpi 300
</code></pre>
</div>

<p>This will read data from <code class="highlighter-rouge">output.json</code> and create PNG figures with a resolution of 300 dots per inch. Both arguments are optional and default to <code class="highlighter-rouge">output.json</code> and <code class="highlighter-rouge">300</code> respectively. To avoid copying the scripts to your working directoy each time you generate new data, you may consider <a href="https://unix.stackexchange.com/questions/26047/how-to-correctly-add-a-path-to-path">adding the script location to your PATH</a>.</p>
</div>
            <p class="text-center">
              <br />
              <a target="_blank" href="/_docs/visualising-results/plotting_python.md" class="btn btn-default githubEditButton" role="button">
                <i class="fa fa-pencil fa-lg"></i> Improve this page
              </a>
            </p>
            <hr>
            





  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/chap/docs/contents_objmtl_file/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        
        
        <li class="next">
          <a href="/chap/docs/plotting_r/">
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
    </div>
    <div class="clear"></div>
    

        </div>

    </div>
</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center">
            CHAP 2018 |
            Powered by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll Doc Theme</a>
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = '/chap'
</script>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="/chap/js/bootstrap.min.js "></script>
<script src="/chap/js/typeahead.bundle.min.js "></script>

<script src="/chap/js/main.js "></script>

</body>

</html>
